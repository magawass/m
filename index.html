<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Magawa Secondary School</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f9; display:flex; flex-direction:column; min-height:100vh; }
header { background:#004466; color:white; padding:15px; text-align:center; position:relative; }
header h2 { margin-top:5px; font-size:18px; font-style:italic; color:#ffdd66; }
.logo { position:absolute; top:10px; left:15px; height:60px; width:auto; border-radius:8px; }
.menu-btn { position: fixed; top:15px; right:20px; font-size:24px; background:#004466; color:white; border:none; padding:10px 15px; cursor:pointer; border-radius:8px; z-index:1001; }
.sidebar { height:100%; width:0; position:fixed; top:0; right:0; background-color:#00334d; overflow-x:hidden; transition:0.3s; padding-top:60px; z-index:1000; }
.sidebar a { padding:12px 24px; text-decoration:none; font-size:18px; color:white; display:block; transition:0.3s; }
.sidebar a:hover { background:#005580; }
.closebtn { position:absolute; top:10px; right:20px; font-size:30px; color:white; cursor:pointer; }
section { padding:20px; display:none; flex-grow:1; }
section.active { display:block; }
.login-box { max-width:400px; margin:30px auto; padding:20px; background:white; border-radius:10px; box-shadow:0 4px 8px rgba(0,0,0,0.2); }
input[type="text"], input[type="password"], input[type="file"], textarea { width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:5px; }
button { background:#004466; color:white; border:none; padding:10px 15px; border-radius:5px; cursor:pointer; margin-top:8px; }
button:hover { background:#006699; }
.logout-btn { background:#aa0000; }
.logout-btn:hover { background:#dd2222; }
.signup-btn { background:#009900; }
.signup-btn:hover { background:#00cc00; }
.public-section { background:white; padding:20px; border-radius:10px; box-shadow:0 4px 8px rgba(0,0,0,0.2); max-width:700px; margin:auto; }
.public-section h3 { color:#004466; border-bottom:2px solid #004466; padding-bottom:5px; }
footer { background:#002233; color:white; text-align:center; padding:15px; font-size:14px; margin-top:auto; }
footer p { margin:5px 0; }
</style>
</head>
<body>

<header>
  <img src="images/logo.png" alt="Magawa Logo" id="school-logo" class="logo">
  <h1>Magawa Secondary School</h1>
  <h2>ENTER TO LEARN, DEPART TO SERVE</h2>
</header>

<button class="menu-btn" onclick="toggleMenu()">â˜° Menu</button>

<div id="mySidebar" class="sidebar">
  <span class="closebtn" onclick="toggleMenu()">&times;</span>
  <a href="#" onclick="showSection('about')">About Us</a>
  <a href="#" onclick="showSection('admissions')">Admissions</a>
  <a href="#" onclick="showSection('public')">Public</a>
  <a href="#" onclick="showSection('student-portal')">Student Portal</a>
  <a href="#" onclick="showSection('admin-portal')">Admin Portal</a>
  <a href="#" onclick="showSection('contact')">Contact</a>
</div>

<main>

  <!-- ABOUT SECTION -->
  <section id="about" class="active">
    <h2>About Us</h2>
    <p id="about-text">Welcome to Magawa Secondary School. We aim to nurture disciplined, knowledgeable, and responsible learners.</p>
    <div id="about-edit" style="display:none;">
      <textarea id="about-edit-text" rows="5"></textarea>
      <button onclick="saveAbout()">Save About</button>
    </div>
  </section>

  <!-- ADMISSIONS -->
  <section id="admissions">
    <h2>Admissions</h2>
    <p id="admissions-text">Admission guidelines and enrollment information will be provided at the start of each academic year.</p>
    <div id="admissions-edit" style="display:none;">
      <textarea id="admissions-edit-text" rows="5"></textarea>
      <button onclick="saveAdmissions()">Save Admissions</button>
    </div>
  </section>

  <!-- PUBLIC -->
  <section id="public">
    <div class="public-section">
      <h2>Public Information</h2>
      <h3>ðŸ“¢ Announcements</h3>
      <ul id="announcements-list"></ul>
      <h3>ðŸŽ‰ Events</h3>
      <ul id="events-list"></ul>
    </div>
  </section>

  <!-- STUDENT PORTAL -->
  <section id="student-portal">
    <div class="login-box" id="student-login">
      <h2>Student Result Portal</h2>
      <input type="text" id="examNumber" placeholder="Enter Exam Number (e.g. 0001)">
      <button onclick="studentLogin()">Login</button>
    </div>

    <div id="student-area" style="display:none; text-align:center;">
      <h3 id="student-welcome"></h3>
      <a id="result-link" href="#" target="_blank">View Result</a>
      <br><br>
      <button class="logout-btn" onclick="studentLogout()">Logout</button>
    </div>
  </section>

  <!-- ADMIN PORTAL -->
  <section id="admin-portal">
    <!-- LOGIN -->
    <div class="login-box" id="admin-login">
      <h2>Admin Login</h2>
      <input type="text" id="adminId" placeholder="Admin ID">
      <input type="password" id="adminPass" placeholder="Password">
      <button onclick="adminLogin()">Login</button>
      <button class="signup-btn" onclick="showAdminSignup()">Sign Up</button>
    </div>

    <!-- SIGN UP -->
    <div class="login-box" id="admin-signup" style="display:none;">
      <h2>Admin Sign Up</h2>
      <input type="text" id="newAdminId" placeholder="Admin ID">
      <input type="password" id="newAdminPassSignup" placeholder="Password">
      <button onclick="adminSignup()">Create Account</button>
      <button onclick="backToAdminLogin()">Back</button>
    </div>

    <!-- ADMIN AREA -->
    <div id="admin-area" style="display:none;">
      <h3>Welcome Admin <span id="admin-welcome"></span></h3>

      <h3>Edit About Us</h3>
      <button onclick="enableEdit('about')">Edit About</button>

      <h3>Edit Admissions</h3>
      <button onclick="enableEdit('admissions')">Edit Admissions</button>

      <h3>Edit Announcements & Events</h3>
      <textarea id="edit-announcements" rows="4" placeholder="Announcements (one per line)"></textarea>
      <textarea id="edit-events" rows="4" placeholder="Events (one per line)"></textarea>
      <button onclick="savePublicInfo()">Save Public Info</button>

      <h3>Edit Contact Info</h3>
      <textarea id="edit-contact" rows="3" placeholder="Edit contact info"></textarea>
      <button onclick="saveContact()">Save Contact</button>

      <h3>Edit Footer</h3>
      <textarea id="edit-footer" rows="2" placeholder="Edit footer"></textarea>
      <button onclick="saveFooter()">Save Footer</button>

      <h3>Update Logo</h3>
      <input type="file" id="logo-upload" accept="image/*">
      <button onclick="saveLogo()">Save Logo</button>

      <h3>Upload Results in Bulk</h3>
      <textarea id="bulk-results" rows="10" placeholder="Paste ExamNo,FileURL per line"></textarea>
      <button onclick="uploadResults()">Upload Results</button>

      <h3>Change Admin Password</h3>
      <input type="password" id="newAdminPass" placeholder="Enter New Password">
      <button onclick="changeAdminPassword()">Change Password</button>

      <br><br>
      <button class="logout-btn" onclick="adminLogout()">Logout</button>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact">
    <h2>Contact Us</h2>
    <p id="contact-info"><b>Address:</b> P.O. Box 25, Magawa, Malawi<br><b>Phone:</b> +265 999 000 000<br><b>Email:</b> info@magawa-secondary.ac.mw</p>
  </section>

</main>

<footer id="footer-text">
  <p>Â© 2025 Magawa Secondary School. All Rights Reserved.</p>
</footer>

<script>
// === MENU ===
function toggleMenu(){
  const s=document.getElementById("mySidebar");
  s.style.width = s.style.width==="250px" ? "0" : "250px";
}
function showSection(id){
  document.querySelectorAll("main section").forEach(e=>e.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.getElementById("mySidebar").style.width="0";
}

// === LOCAL STORAGE HELPERS ===
function getAdmins(){return JSON.parse(localStorage.getItem('admins')||'{}');}
function saveAdmins(a){localStorage.setItem('admins',JSON.stringify(a));}
function getStudents(){return JSON.parse(localStorage.getItem('students')||'{}');}
function saveStudents(s){localStorage.setItem('students',JSON.stringify(s));}

// === STUDENT PORTAL ===
function studentLogin(){
  const examNumber=document.getElementById('examNumber').value.trim().padStart(4,'0');
  const students=getStudents();
  if(students[examNumber]){
    document.getElementById('student-login').style.display='none';
    document.getElementById('student-area').style.display='block';
    document.getElementById('student-welcome').innerText=`Welcome Candidate No: ${examNumber}`;
    document.getElementById('result-link').href=students[examNumber];
  } else alert('Result not found for this Exam Number.');
}
function studentLogout(){
  document.getElementById('student-login').style.display='block';
  document.getElementById('student-area').style.display='none';
}

// === ADMIN PORTAL ===
function adminLogin(){
  const id=document.getElementById('adminId').value.trim();
  const pass=document.getElementById('adminPass').value.trim();
  const admins=getAdmins();
  if(admins[id] && admins[id]===pass){
    document.getElementById('admin-login').style.display='none';
    document.getElementById('admin-area').style.display='block';
    document.getElementById('admin-welcome').innerText=id;
  } else alert('Invalid Admin ID or password.');
}
function showAdminSignup(){
  document.getElementById('admin-login').style.display='none';
  document.getElementById('admin-signup').style.display='block';
}
function backToAdminLogin(){
  document.getElementById('admin-login').style.display='block';
  document.getElementById('admin-signup').style.display='none';
}
function adminSignup(){
  const id=document.getElementById('newAdminId').value.trim();
  const pass=document.getElementById('newAdminPassSignup').value.trim();
  if(!id||!pass){alert('Enter both ID and Password'); return;}
  const admins=getAdmins();
  admins[id]=pass; saveAdmins(admins);
  alert('Admin registered successfully');
  backToAdminLogin();
}
function adminLogout(){
  document.getElementById('admin-login').style.display='block';
  document.getElementById('admin-area').style.display='none';
}
function changeAdminPassword(){
  const newPass=document.getElementById('newAdminPass').value.trim();
  const id=document.getElementById('admin-welcome').innerText;
  if(newPass.length<3){alert('Password too short');return;}
  const admins=getAdmins();
  admins[id]=newPass; saveAdmins(admins);
  alert('Password changed successfully');
}

// === EDIT SECTIONS ===
function enableEdit(section){
  if(section==='about'){
    document.getElementById('about-edit').style.display='block';
    document.getElementById('about-edit-text').value=document.getElementById('about-text').innerText;
  }
  if(section==='admissions'){
    document.getElementById('admissions-edit').style.display='block';
    document.getElementById('admissions-edit-text').value=document.getElementById('admissions-text').innerText;
  }
}
function saveAbout(){
  const txt=document.getElementById('about-edit-text').value.trim();
  if(txt){
    document.getElementById('about-text').innerText=txt;
    localStorage.setItem('aboutText',txt);
  }
  alert('About saved');
  document.getElementById('about-edit').style.display='none';
}
function saveAdmissions(){
  const txt=document.getElementById('admissions-edit-text').value.trim();
  if(txt){
    document.getElementById('admissions-text').innerText=txt;
    localStorage.setItem('admissionsText',txt);
  }
  alert('Admissions saved');
  document.getElementById('admissions-edit').style.display='none';
}
function savePublicInfo(){
  const ann=document.getElementById('edit-announcements').value.split("\n").filter(l=>l.trim());
  const ev=document.getElementById('edit-events').value.split("\n").filter(l=>l.trim());
  localStorage.setItem('announcements',JSON.stringify(ann));
  localStorage.setItem('events',JSON.stringify(ev));
  loadPublic();
  alert('Public info saved');
}
function saveContact(){
  const info=document.getElementById('edit-contact').value.trim();
  if(info){
    document.getElementById('contact-info').innerHTML=info;
    localStorage.setItem('contactInfo',info);
  }
  alert('Contact saved');
}
function saveFooter(){
  const f=document.getElementById('edit-footer').value.trim();
  if(f){
    document.getElementById('footer-text').innerHTML=`<p>${f}</p>`;
    localStorage.setItem('footerText',f);
  }
  alert('Footer saved');
}
function saveLogo(){
  const file=document.getElementById('logo-upload').files[0];
  if(file){
    const r=new FileReader();
    r.onload=e=>{
      document.getElementById('school-logo').src=e.target.result;
      localStorage.setItem('schoolLogo',e.target.result);
    };
    r.readAsDataURL(file);
  }
  alert('Logo saved');
}
function uploadResults(){
  const data=document.getElementById('bulk-results').value.split("\n").filter(l=>l.trim());
  const students=getStudents();
  let count=0;
  data.forEach(line=>{
    const parts=line.split(",");
    if(parts.length===2){
      const exam=parts[0].trim().padStart(4,'0');
      const url=parts[1].trim();
      if(url){students[exam]=url; count++;}
    }
  });
  saveStudents(students);
  alert(`${count} results uploaded`);
}

// === LOAD SAVED DATA ===
function loadPublic(){
  const ann=JSON.parse(localStorage.getItem('announcements')||'[]');
  const ev=JSON.parse(localStorage.getItem('events')||'[]');
  document.getElementById('announcements-list').innerHTML=ann.map(a=>`<li>${a}</li>`).join('');
  document.getElementById('events-list').innerHTML=ev.map(e=>`<li>${e}</li>`).join('');
}
window.onload=function(){
  loadPublic();
  const at=localStorage.getItem('aboutText');
  const ad=localStorage.getItem('admissionsText');
  const ci=localStorage.getItem('contactInfo');
  const ft=localStorage.getItem('footerText');
  const lg=localStorage.getItem('schoolLogo');
  if(at)document.getElementById('about-text').innerText=at;
  if(ad)document.getElementById('admissions-text').innerText=ad;
  if(ci)document.getElementById('contact-info').innerHTML=ci;
  if(ft)document.getElementById('footer-text').innerHTML=`<p>${ft}</p>`;
  if(lg)document.getElementById('school-logo').src=lg;
};
</script>

</body>
</html>
